{"version":3,"file":"index.native.umd.js","sources":["../src/native/index.ts"],"sourcesContent":["import {\n  ComponentType,\n  Context as ContextOrig,\n  MutableRefObject,\n  Provider,\n  ReactNode,\n  createElement,\n  createContext as createContextOrig,\n  useContext as useContextOrig,\n  useEffect,\n  useLayoutEffect,\n  useReducer,\n  useRef,\n  useState,\n} from 'react';\nimport {\n  unstable_NormalPriority as NormalPriority,\n  unstable_runWithPriority as runWithPriority,\n} from 'scheduler';\n\nimport { batchedUpdates } from './batchedUpdates';\n\nconst CONTEXT_VALUE = Symbol();\nconst ORIGINAL_PROVIDER = Symbol();\n\nconst isSSR = typeof window === 'undefined'\n  || /ServerSideRendering/.test(window.navigator && window.navigator.userAgent);\n\nconst useIsomorphicLayoutEffect = isSSR ? useEffect : useLayoutEffect;\n\n// for preact that doesn't have runWithPriority\nconst runWithNormalPriority = runWithPriority\n  ? (thunk: () => void) => {\n    try {\n      runWithPriority(NormalPriority, thunk);\n    } catch (e: any) {\n      if (e.message === 'Not implemented.') {\n        thunk();\n      } else {\n        throw e;\n      }\n    }\n  } : (thunk: () => void) => thunk();\n\ntype Version = number;\ntype Listener<Value> = (\n  action: { n: Version, p?: Promise<Value>, v?: Value }\n) => void\n\ntype ContextValue<Value> = {\n  [CONTEXT_VALUE]: {\n    /* \"v\"alue     */ v: MutableRefObject<Value>;\n    /* versio\"n\"   */ n: MutableRefObject<Version>;\n    /* \"l\"isteners */ l: Set<Listener<Value>>;\n    /* \"u\"pdate    */ u: (thunk: () => void, options?: { suspense: boolean }) => void;\n  };\n};\n\nexport interface Context<Value> {\n  Provider: ComponentType<{ value: Value; children: ReactNode }>;\n  displayName?: string;\n}\n\nconst createProvider = <Value>(\n  ProviderOrig: Provider<ContextValue<Value>>,\n) => {\n  const ContextProvider = ({ value, children }: { value: Value; children: ReactNode }) => {\n    const valueRef = useRef(value);\n    const versionRef = useRef(0);\n    const [resolve, setResolve] = useState<((v: Value) => void) | null>(null);\n    if (resolve) {\n      resolve(value);\n      setResolve(null);\n    }\n    const contextValue = useRef<ContextValue<Value>>();\n    if (!contextValue.current) {\n      const listeners = new Set<Listener<Value>>();\n      const update = (thunk: () => void, options?: { suspense: boolean }) => {\n        batchedUpdates(() => {\n          versionRef.current += 1;\n          const action: Parameters<Listener<Value>>[0] = {\n            n: versionRef.current,\n          };\n          if (options?.suspense) {\n            action.n *= -1; // this is intentional to make it temporary version\n            action.p = new Promise<Value>((r) => {\n              setResolve(() => (v: Value) => {\n                action.v = v;\n                delete action.p;\n                r(v);\n              });\n            });\n          }\n          listeners.forEach((listener) => listener(action));\n          thunk();\n        });\n      };\n      contextValue.current = {\n        [CONTEXT_VALUE]: {\n          /* \"v\"alue     */ v: valueRef,\n          /* versio\"n\"   */ n: versionRef,\n          /* \"l\"isteners */ l: listeners,\n          /* \"u\"pdate    */ u: update,\n        },\n      };\n    }\n    useIsomorphicLayoutEffect(() => {\n      valueRef.current = value;\n      versionRef.current += 1;\n      runWithNormalPriority(() => {\n        (contextValue.current as ContextValue<Value>)[CONTEXT_VALUE].l.forEach((listener) => {\n          listener({ n: versionRef.current, v: value });\n        });\n      });\n    }, [value]);\n    return createElement(ProviderOrig, { value: contextValue.current }, children);\n  };\n  return ContextProvider;\n};\n\nconst identity = <T>(x: T) => x;\n\n/**\n * This creates a special context for `useContextSelector`.\n *\n * @example\n * import { createContext } from 'use-context-selector';\n *\n * const PersonContext = createContext({ firstName: '', familyName: '' });\n */\nexport function createContext<Value>(defaultValue: Value) {\n  const context = createContextOrig<ContextValue<Value>>({\n    [CONTEXT_VALUE]: {\n      /* \"v\"alue     */ v: { current: defaultValue },\n      /* versio\"n\"   */ n: { current: -1 },\n      /* \"l\"isteners */ l: new Set(),\n      /* \"u\"pdate    */ u: (f) => f(),\n    },\n  });\n  (context as unknown as {\n    [ORIGINAL_PROVIDER]: Provider<ContextValue<Value>>;\n  })[ORIGINAL_PROVIDER] = context.Provider;\n  (context as unknown as Context<Value>).Provider = createProvider(context.Provider);\n  delete (context as any).Consumer; // no support for Consumer\n  return context as unknown as Context<Value>;\n}\n\n/**\n * This hook returns context selected value by selector.\n *\n * It will only accept context created by `createContext`.\n * It will trigger re-render if only the selected value is referentially changed.\n *\n * The selector should return referentially equal result for same input for better performance.\n *\n * @example\n * import { useContextSelector } from 'use-context-selector';\n *\n * const firstName = useContextSelector(PersonContext, state => state.firstName);\n */\nexport function useContextSelector<Value, Selected>(\n  context: Context<Value>,\n  selector: (value: Value) => Selected,\n) {\n  const contextValue = useContextOrig(\n    context as unknown as ContextOrig<ContextValue<Value>>,\n  )[CONTEXT_VALUE];\n  if (typeof process === 'object' && process.env.NODE_ENV !== 'production') {\n    if (!contextValue) {\n      throw new Error('useContextSelector requires special context');\n    }\n  }\n  const {\n    /* \"v\"alue     */ v: { current: value },\n    /* versio\"n\"   */ n: { current: version },\n    /* \"l\"isteners */ l: listeners,\n  } = contextValue;\n  const selected = selector(value);\n  const [state, dispatch] = useReducer((\n    prev: readonly [Value, Selected],\n    action?: Parameters<Listener<Value>>[0],\n  ) => {\n    if (!action) {\n      // case for `dispatch()` below\n      return [value, selected] as const;\n    }\n    if ('p' in action) {\n      throw action.p;\n    }\n    if (action.n === version) {\n      if (Object.is(prev[1], selected)) {\n        return prev; // bail out\n      }\n      return [value, selected] as const;\n    }\n    try {\n      if ('v' in action) {\n        if (Object.is(prev[0], action.v)) {\n          return prev; // do not update\n        }\n        const nextSelected = selector(action.v);\n        if (Object.is(prev[1], nextSelected)) {\n          return prev; // do not update\n        }\n        return [action.v, nextSelected] as const;\n      }\n    } catch (e) {\n      // ignored (stale props or some other reason)\n    }\n    return [...prev] as const; // schedule update\n  }, [value, selected] as const);\n  if (!Object.is(state[1], selected)) {\n    // schedule re-render\n    // this is safe because it's self contained\n    dispatch();\n  }\n  useIsomorphicLayoutEffect(() => {\n    listeners.add(dispatch);\n    return () => {\n      listeners.delete(dispatch);\n    };\n  }, [listeners]);\n  return state[1];\n}\n\n/**\n * This hook returns the entire context value.\n * Use this instead of React.useContext for consistent behavior.\n *\n * @example\n * import { useContext } from 'use-context-selector';\n *\n * const person = useContext(PersonContext);\n */\nexport function useContext<Value>(context: Context<Value>) {\n  return useContextSelector(context, identity);\n}\n\n/**\n * This hook returns an update function that accepts a thunk function\n *\n * Use this for a function that will change a value in\n * concurrent rendering in React 18.\n * Otherwise, there's no need to use this hook.\n *\n * @example\n * import { useContextUpdate } from 'use-context-selector';\n *\n * const update = useContextUpdate();\n *\n * // Wrap set state function\n * update(() => setState(...));\n *\n * // Experimental suspense mode\n * update(() => setState(...), { suspense: true });\n */\nexport function useContextUpdate<Value>(context: Context<Value>) {\n  const contextValue = useContextOrig(\n    context as unknown as ContextOrig<ContextValue<Value>>,\n  )[CONTEXT_VALUE];\n  if (typeof process === 'object' && process.env.NODE_ENV !== 'production') {\n    if (!contextValue) {\n      throw new Error('useContextUpdate requires special context');\n    }\n  }\n  const { u: update } = contextValue;\n  return update;\n}\n\n/**\n * This is a Provider component for bridging multiple react roots\n *\n * @example\n * const valueToBridge = useBridgeValue(PersonContext);\n * return (\n *   <Renderer>\n *     <BridgeProvider context={PersonContext} value={valueToBridge}>\n *       {children}\n *     </BridgeProvider>\n *   </Renderer>\n * );\n */\nexport const BridgeProvider = ({ context, value, children }:{\n  context: Context<any>;\n  value: any;\n  children: ReactNode;\n}) => {\n  const { [ORIGINAL_PROVIDER]: ProviderOrig } = context as unknown as {\n    [ORIGINAL_PROVIDER]: Provider<unknown>;\n  };\n  if (typeof process === 'object' && process.env.NODE_ENV !== 'production') {\n    if (!ProviderOrig) {\n      throw new Error('BridgeProvider requires special context');\n    }\n  }\n  return createElement(ProviderOrig, { value }, children);\n};\n\n/**\n * This hook return a value for BridgeProvider\n */\nexport const useBridgeValue = (context: Context<any>) => {\n  const bridgeValue = useContextOrig(context as unknown as ContextOrig<ContextValue<unknown>>);\n  if (typeof process === 'object' && process.env.NODE_ENV !== 'production') {\n    if (!bridgeValue[CONTEXT_VALUE]) {\n      throw new Error('useBridgeValue requires special context');\n    }\n  }\n  return bridgeValue as any;\n};\n"],"names":["CONTEXT_VALUE","Symbol","ORIGINAL_PROVIDER","isSSR","window","test","navigator","userAgent","useIsomorphicLayoutEffect","useEffect","useLayoutEffect","runWithNormalPriority","runWithPriority","thunk","NormalPriority","e","message","createProvider","ProviderOrig","ContextProvider","_ref","value","children","valueRef","useRef","versionRef","_useState","useState","resolve","setResolve","contextValue","current","_contextValue$current","listeners","Set","update","options","batchedUpdates","action","n","suspense","p","Promise","r","v","forEach","listener","l","u","createElement","identity","x","createContext","defaultValue","_createContextOrig","context","createContextOrig","f","Provider","Consumer","useContextSelector","selector","useContextOrig","process","env","NODE_ENV","Error","version","selected","_useReducer","useReducer","prev","Object","is","nextSelected","concat","state","dispatch","add","useContext","useContextUpdate","BridgeProvider","_ref2","useBridgeValue","bridgeValue"],"mappings":"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"}